2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Current SDK version is 0.17.9
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Configure stats pid to 240285
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Loading settings from /home/insq/.config/wandb/settings
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Loading settings from /home/insq/PHC/wandb/settings
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Loading settings from environment variables: {}
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Applying setup settings: {'_disable_service': False}
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Inferring run settings from compute environment: {'program_relpath': 'phc/run_hydra.py', 'program_abspath': '/home/insq/PHC/phc/run_hydra.py', 'program': 'phc/run_hydra.py'}
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Applying login settings: {}
2024-09-07 12:26:58,272 INFO    MainThread:240285 [wandb_setup.py:_flush():77] Applying login settings: {'mode': 'offline'}
2024-09-07 12:26:58,273 INFO    MainThread:240285 [wandb_init.py:_log_setup():524] Logging user logs to /home/insq/PHC/wandb/offline-run-20240907_122658-z6eyvf70/logs/debug.log
2024-09-07 12:26:58,273 INFO    MainThread:240285 [wandb_init.py:_log_setup():525] Logging internal logs to /home/insq/PHC/wandb/offline-run-20240907_122658-z6eyvf70/logs/debug-internal.log
2024-09-07 12:26:58,273 INFO    MainThread:240285 [wandb_init.py:init():608] calling init triggers
2024-09-07 12:26:58,273 INFO    MainThread:240285 [wandb_init.py:init():615] wandb.init called with sweep_config: {}
config: {}
2024-09-07 12:26:58,273 INFO    MainThread:240285 [wandb_init.py:init():658] starting backend
2024-09-07 12:26:58,273 INFO    MainThread:240285 [wandb_init.py:init():662] setting up manager
2024-09-07 12:26:58,273 INFO    MainThread:240285 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-09-07 12:26:58,274 INFO    MainThread:240285 [wandb_init.py:init():670] backend started and connected
2024-09-07 12:26:58,275 INFO    MainThread:240285 [wandb_init.py:init():768] updated telemetry
2024-09-07 12:26:58,322 INFO    MainThread:240285 [wandb_init.py:init():801] communicating run to backend with 90.0 second timeout
2024-09-07 12:26:58,324 INFO    MainThread:240285 [wandb_init.py:init():852] starting run threads in backend
2024-09-07 12:27:01,012 INFO    MainThread:240285 [wandb_run.py:_console_start():2465] atexit reg
2024-09-07 12:27:01,012 INFO    MainThread:240285 [wandb_run.py:_redirect():2311] redirect: wrap_raw
2024-09-07 12:27:01,012 INFO    MainThread:240285 [wandb_run.py:_redirect():2376] Wrapping output streams.
2024-09-07 12:27:01,012 INFO    MainThread:240285 [wandb_run.py:_redirect():2401] Redirects installed.
2024-09-07 12:27:01,013 INFO    MainThread:240285 [wandb_init.py:init():895] run started, returning control to user process
2024-09-07 12:27:01,014 INFO    MainThread:240285 [wandb_run.py:_config_callback():1392] config_cb None None {'project_name': 'PHC', 'notes': 'Default Notes', 'exp_name': 'phc_comp_3', 'headless': False, 'seed': 0, 'no_log': False, 'resume_str': None, 'num_threads': 64, 'test': False, 'output_path': 'output/HumanoidIm/phc_comp_3', 'torch_deterministic': False, 'epoch': 0, 'im_eval': True, 'horovod': False, 'rl_device': 'cuda:0', 'device': 'cuda', 'device_id': 0, 'metadata': False, 'play': False, 'train': True, 'server_mode': False, 'has_eval': True, 'no_virtual_display': False, 'render_o3d': False, 'debug': False, 'follow': False, 'add_proj': False, 'real_traj': False, 'env': {'task': 'HumanoidImMCPGetup', 'project_name': 'PHC', 'notes': 'Progressive MCP without softmax, zero out far', 'motion_file': 'sample_data/amass_isaac_standing_upright_slim.pkl', 'num_envs': 1, 'env_spacing': 2, 'episode_length': 300, 'is_flag_run': False, 'enable_debug_vis': False, 'sym_loss_coef': 1, 'fut_tracks': False, 'obs_v': 6, 'auto_pmcp': False, 'auto_pmcp_soft': True, 'has_pnn': True, 'fitting': True, 'num_prim': 3, 'training_prim': 0, 'actors_to_load': 4, 'has_lateral': False, 'models': ['output/HumanoidIm/phc_3/Humanoid.pth'], 'zero_out_far': False, 'zero_out_far_train': False, 'cycle_motion': True, 'getup_udpate_epoch': 1000, 'getup_schedule': True, 'recoverySteps': 90, 'zero_out_far_steps': 90, 'recoveryEpisodeProb': 0.5, 'fallInitProb': 0.3, 'hard_negative': False, 'z_activation': 'silu', 'kp_scale': 1, 'power_reward': True, 'power_coefficient': 5e-05, 'shape_resampling_interval': 500, 'control_mode': 'isaac_pd', 'power_scale': 1.0, 'controlFrequencyInv': 2, 'stateInit': 'Random', 'hybridInitProb': 0.5, 'numAMPObsSteps': 10, 'local_root_obs': True, 'root_height_obs': True, 'key_bodies': ['R_Ankle', 'L_Ankle', 'R_Wrist', 'L_Wrist'], 'contact_bodies': ['R_Ankle', 'L_Ankle', 'R_Toe', 'L_Toe'], 'reset_bodies': ['Pelvis', 'L_Hip', 'L_Knee', 'R_Hip', 'R_Knee', 'Torso', 'Spine', 'Chest', 'Neck', 'Head', 'L_Thorax', 'L_Shoulder', 'L_Elbow', 'L_Wrist', 'L_Hand', 'R_Thorax', 'R_Shoulder', 'R_Elbow', 'R_Wrist', 'R_Hand'], 'terminationHeight': 0.15, 'enableEarlyTermination': True, 'terminationDistance': 0.25, 'numTrajSamples': 3, 'trajSampleTimestepInv': 3, 'enableTaskObs': True, 'asset': {'assetRoot': '/', 'assetFileName': 'mjcf/smpl_humanoid.xml'}, 'plane': {'staticFriction': 1.0, 'dynamicFriction': 1.0, 'restitution': 0.0}, 'sim': None, 'substeps': 2, 'physx': {'num_threads': 4, 'solver_type': 1, 'num_position_iterations': 4, 'num_velocity_iterations': 0, 'contact_offset': 0.02, 'rest_offset': 0.0, 'bounce_threshold_velocity': 0.2, 'max_depenetration_velocity': 10.0, 'default_buffer_size_multiplier': 10.0}, 'flex': {'num_inner_iterations': 10, 'warm_start': 0.25}}, 'robot': {'humanoid_type': 'smpl', 'bias_offset': False, 'has_self_collision': True, 'has_mesh': False, 'has_jt_limit': False, 'has_dof_subset': True, 'has_upright_start': True, 'has_smpl_pd_offset': False, 'remove_toe': False, 'motion_sym_loss': False, 'sym_loss_coef': 1, 'big_ankle': True, 'has_shape_obs': False, 'has_shape_obs_disc': False, 'has_shape_variation': False, 'masterfoot': False, 'freeze_toe': False, 'freeze_hand': False, 'box_body': True, 'real_weight': True, 'real_weight_porpotion_capsules': True, 'real_weight_porpotion_boxes': False, 'asset': {'assetRoot': '/', 'assetFileName': 'mjcf/smpl_humanoid.xml'}}, 'learning': {'params': {'seed': 0, 'algo': {'name': 'im_amp'}, 'model': {'name': 'amp'}, 'network': {'name': 'amp_mcp', 'separate': True, 'discrete': False, 'has_softmax': False, 'ending_act': True, 'space': {'continuous': {'mu_activation': 'None', 'sigma_activation': 'None', 'mu_init': {'name': 'default'}, 'sigma_init': {'name': 'const_initializer', 'val': -2.9}, 'fixed_sigma': True, 'learn_sigma': False}}, 'mlp': {'units': [2048, 1536, 1024, 1024, 512, 512], 'activation': 'silu', 'd2rl': False, 'initializer': {'name': 'default'}, 'regularizer': {'name': 'None'}}, 'disc': {'units': [1024, 512], 'activation': 'relu', 'initializer': {'name': 'default'}}}, 'load_checkpoint': False, 'config': {'name': 'Humanoid', 'env_name': 'rlgpu', 'multi_gpu': False, 'ppo': True, 'mixed_precision': False, 'normalize_input': True, 'normalize_value': True, 'reward_shaper': {'scale_value': 1}, 'normalize_advantage': True, 'gamma': 0.99, 'tau': 0.95, 'learning_rate': 2e-05, 'lr_schedule': 'constant', 'score_to_win': 20000, 'max_epochs': 10000000, 'save_best_after': 100, 'save_frequency': 500, 'print_stats': False, 'save_intermediate': True, 'entropy_coef': 0.0, 'truncate_grads': True, 'grad_norm': 50.0, 'e_clip': 0.2, 'horizon_length': 32, 'minibatch_size': 16384, 'mini_epochs': 6, 'critic_coef': 5, 'clip_value': False, 'bounds_loss_coef': 10, 'amp_obs_demo_buffer_size': 200000, 'amp_replay_buffer_size': 200000, 'amp_replay_keep_prob': 0.01, 'amp_batch_size': 512, 'amp_minibatch_size': 4096, 'disc_coef': 5, 'disc_logit_reg': 0.01, 'disc_grad_penalty': 5, 'disc_reward_scale': 2, 'disc_weight_decay': 0.0001, 'normalize_amp_input': True, 'task_reward_w': 0.5, 'disc_reward_w': 0.5, 'amp_dropout': True, 'player': {'games_num': 999999999999999999999999}}}}, 'sim': {'sim_device': 'cuda:0', 'pipeline': 'gpu', 'graphics_device_id': 0, 'subscenes': 0, 'slices': 0, 'use_flex': False, 'substeps': 2, 'physx': {'num_threads': 4, 'solver_type': 1, 'num_position_iterations': 4, 'num_velocity_iterations': 0, 'contact_offset': 0.02, 'rest_offset': 0.0, 'bounce_threshold_velocity': 0.2, 'max_depenetration_velocity': 10.0, 'default_buffer_size_multiplier': 10.0}, 'flex': {'num_inner_iterations': 10, 'warm_start': 0.25}}}
2024-09-07 12:27:02,127 WARNING MsgRouterThr:240285 [router.py:message_loop():77] message_loop has been closed
